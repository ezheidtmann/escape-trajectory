<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CVODE Trajectory Generator: RestrictedThree::updateInitialVectorComp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CVODE Trajectory Generator
   &#160;<span id="projectnumber">Version 1: Summer 2007</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="classRestrictedThree.html">RestrictedThree</a></li>  </ul>
</div>
</div><!-- top -->
<div class="contents">
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
   <td valign="top">
      <div class="navtab">
        <table>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_a28434ad91c09d73cde1b1c79a6f311ab.html#a28434ad91c09d73cde1b1c79a6f311ab">denseJac</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_a5234a081827be46c45ec004ad1845e51.html#a5234a081827be46c45ec004ad1845e51">enablePseudoEnergy</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_a85787f83a701457cc08109fd15ef18c2.html#a85787f83a701457cc08109fd15ef18c2">enableTotalDistance</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_ad6f50a692487dddf8ec40f092566520a.html#ad6f50a692487dddf8ec40f092566520a">enableWindingNumber</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_a526cd9bc3124e31feb292dc6f8332864.html#a526cd9bc3124e31feb292dc6f8332864">getOptionString</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_aaed5af1b1fba2e558b7050a5aeb04a77.html#aaed5af1b1fba2e558b7050a5aeb04a77">getVectorSize</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_a0e819007739fdd88d39c0fd6e837b0c1.html#a0e819007739fdd88d39c0fd6e837b0c1">handleOption</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_aefc689f60031fa69c49ca6127664bdd1.html#aefc689f60031fa69c49ca6127664bdd1">postStep</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_afc876ae2817e84685d97a426d177efdf.html#afc876ae2817e84685d97a426d177efdf">recordData</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_a6da5f141603c2b90266e1e8fd3936d16.html#a6da5f141603c2b90266e1e8fd3936d16">recordDataInit</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_aafee4839b0420d19ea86bc079d7cb706.html#aafee4839b0420d19ea86bc079d7cb706">RestrictedThree</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_a912091a11dbb81189a88f090b31e6594.html#a912091a11dbb81189a88f090b31e6594">rhsFunc</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_afb1a8c41baf7c460a1ad8acd8d44bde3.html#afb1a8c41baf7c460a1ad8acd8d44bde3">setCaptureRadius</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_a21c71f85159e8a4269075dc254dd46d2.html#a21c71f85159e8a4269075dc254dd46d2">setLaunchAngle</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_ad87280b364993deb984ac9b2520c7f50.html#ad87280b364993deb984ac9b2520c7f50">setLaunchRadius</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_a71bad5ae3a3c0539923e975b6b83a1d9.html#a71bad5ae3a3c0539923e975b6b83a1d9">setLaunchSpeed</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_a4b745617c977b8a484a4a213e475ba96.html#a4b745617c977b8a484a4a213e475ba96">setLaunchSpeedMagnification</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_a17e28fb03172515de57df2c84fc74b68.html#a17e28fb03172515de57df2c84fc74b68">setLaunchSpeedMinimum</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_ab8f16be0a6b90c872beab26129e582be.html#ab8f16be0a6b90c872beab26129e582be">setLaunchSpeedX</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_a3d206a5ca252b76e70c30e95d7f50ceb.html#a3d206a5ca252b76e70c30e95d7f50ceb">setLaunchSpeedY</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_a43aefc789e4b60682522ecc73336819f.html#a43aefc789e4b60682522ecc73336819f">setMassFraction</a></td></tr>
          <tr><td class="navtab"><a class="qindexHL" href="classRestrictedThree_ae52ab202ffb3e16615e72285d7742bf6.html#ae52ab202ffb3e16615e72285d7742bf6">updateInitialVectorComp</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classRestrictedThree_af8e8f9c308095cf2d5d3a24365a4c43d.html#af8e8f9c308095cf2d5d3a24365a4c43d">updateInitialVectorPolar</a></td></tr>
        </table>
      </div>
   </td>
   <td valign="top" class="mempage">
<a class="anchor" id="ae52ab202ffb3e16615e72285d7742bf6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RestrictedThree::updateInitialVectorComp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update the initial vector to match launch radius and velocity in X and Y directions (the "component"-wise representation of initial velocity). </p>
<p>If speed is given as a parameter, then the following mapping function is applied:</p>
<p>Given a parameter speed in components <img class="formulaInl" alt="$P_x$" src="form_19.png"/> and <img class="formulaInl" alt="$P_y$" src="form_20.png"/>, the actual velocity is found by components:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} V_x &amp;=&amp; \frac{V_x}{m} + V_s \cos \Theta\\ v &amp;=&amp; \frac{V_x}{m} + V_s \cos \left( \arccos \left( \frac{P_x}{\sqrt{P_x^2 + P_y^2}} \right) \right)\\ v &amp;=&amp; \frac{V_x}{m} + V_s \left( \frac{P_x}{ \sqrt{P_x^2 + P_y^2} } \right)\\ V_y &amp;=&amp; \frac{V_y}{m} + V_s \left( \frac{P_y}{ \sqrt{P_x^2 + P_y^2} } \right) \end{eqnarray*}" src="form_21.png"/>
</p>
<p>Internally the variables are represented like this:</p>
<ul>
<li><code>_launch_speed_x:</code> <img class="formulaInl" alt="$P_x$" src="form_19.png"/></li>
<li><code>_launch_speed_y:</code> <img class="formulaInl" alt="$P_y$" src="form_20.png"/></li>
<li><code>_v_map_slope:</code> <img class="formulaInl" alt="$m$" src="form_22.png"/></li>
<li><code>vx:</code> <img class="formulaInl" alt="$V_x$" src="form_23.png"/></li>
<li><code>vy:</code> <img class="formulaInl" alt="$V_y$" src="form_24.png"/></li>
</ul>
<p>If the speed is given as pseudo-energy (if the <code>-G</code> option is present), then the parameters <code>_launch_speed_x</code> and <code>_launch_speed_y</code> are used to calculate a launch angle and then the magnitude is interpreted as pseudo-energy. The launch speed is then found from the formula for pseudo-energy.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="classRestrictedThree_ab8f16be0a6b90c872beab26129e582be.html#ab8f16be0a6b90c872beab26129e582be" title="Set launch speed in the X direction.">setLaunchSpeedX()</a> </dd>
<dd>
<a class="el" href="classRestrictedThree_a3d206a5ca252b76e70c30e95d7f50ceb.html#a3d206a5ca252b76e70c30e95d7f50ceb" title="Set launch speed in the Y direction.">setLaunchSpeedY()</a> </dd>
<dd>
<a class="el" href="classRestrictedThree_a4b745617c977b8a484a4a213e475ba96.html#a4b745617c977b8a484a4a213e475ba96" title="Set launch speed magnification.">setLaunchSpeedMagnification()</a> </dd>
<dd>
<a class="el" href="classRestrictedThree_a17e28fb03172515de57df2c84fc74b68.html#a17e28fb03172515de57df2c84fc74b68" title="Set minimum launch speed.">setLaunchSpeedMinimum()</a> </dd></dl>

<p>Definition at line <a class="el" href="RestrictedThree_8cpp_source.html#l00373">373</a> of file <a class="el" href="RestrictedThree_8cpp_source.html">RestrictedThree.cpp</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    realtype vx, vy, unmappedx, unmappedy, unmapped_mag;</div>
<div class="line"></div>
<div class="line">    realtype mag, cosq, sinq;</div>
<div class="line">    mag = sqrt(SQUARE(_launch_speed_x) + SQUARE(_launch_speed_y));</div>
<div class="line"></div>
<div class="line">    cosq = _launch_speed_x / mag;</div>
<div class="line">    sinq = _launch_speed_y / mag;</div>
<div class="line"></div>
<div class="line">    unmappedx = (_launch_speed_x) * _v_map_slope + _min_launch_speed * cosq;</div>
<div class="line">    unmappedy = (_launch_speed_y) * _v_map_slope + _min_launch_speed * sinq;</div>
<div class="line">    unmapped_mag = mag * _v_map_slope + _min_launch_speed;</div>
<div class="line"></div>
<div class="line">    vector&lt;realtype&gt; v(<a class="code" href="classRestrictedThree_aaed5af1b1fba2e558b7050a5aeb04a77.html#aaed5af1b1fba2e558b7050a5aeb04a77" title="This problem consists of 4 ODEs, so this function always returns 4.">getVectorSize</a>());</div>
<div class="line">    v.at(0) = _launch_radius * cosq + _dist_com_earth;</div>
<div class="line">    v.at(1) = _launch_radius * sinq;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (_speed_parameter == SPEED_PARAMETER)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Calculate the square of escape speed from earth alone</span></div>
<div class="line">        realtype ve2;</div>
<div class="line">        ve2 = 2*_mass_earth/_launch_radius;</div>
<div class="line"></div>
<div class="line">        vx = sqrt( unmappedx*cosq + ve2*cosq*cosq ) * SIGN(cosq);</div>
<div class="line">        vy = sqrt( unmappedy*sinq + ve2*sinq*sinq ) * SIGN(sinq);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_speed_parameter == SPEED_ENERGY)</div>
<div class="line">    {</div>
<div class="line">        realtype gpe, x, y;</div>
<div class="line">        </div>
<div class="line">        x = v.at(0);</div>
<div class="line">        y = v.at(1);</div>
<div class="line">        </div>
<div class="line">        gpe = _mass_earth / _launch_radius +</div>
<div class="line">                _mass_sun / </div>
<div class="line">                    sqrt(</div>
<div class="line">                        SQUARE(_dist_com_sun + x) +</div>
<div class="line">                        SQUARE(y)</div>
<div class="line">                    );</div>
<div class="line">            </div>
<div class="line">        realtype a, b, c; <span class="comment">// a,b,c in ax^2 + bx + c = 0</span></div>
<div class="line"></div>
<div class="line">        a = 0.5;</div>
<div class="line">        b = _mass_sun * sinq + y * cosq - x * sinq;</div>
<div class="line">        c = _mass_sun*_mass_sun / 2 - x * _mass_sun - </div>
<div class="line">                gpe - unmapped_mag + 1.5;</div>
<div class="line">        </div>
<div class="line">        realtype v0;</div>
<div class="line"></div>
<div class="line">        v0 = (-b + sqrt(b*b - 4*a*c)) / (2*a); <span class="comment">// quadratic formula</span></div>
<div class="line"></div>
<div class="line">        vx = v0 * cosq;</div>
<div class="line">        vy = v0 * sinq;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        vx = vx * (sqrt(2*_mass_earth/_launch_radius));</div>
<div class="line">        vy = vy * (sqrt(2*_mass_earth/_launch_radius));</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    v.at(2) = vx;</div>
<div class="line">    v.at(3) = vy + _dist_com_earth;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classAbstractProblem_abb1938f1e43494471397797862bc6b76.html#abb1938f1e43494471397797862bc6b76" title="Set vector of initial conditions in this problem.">setInitialVector</a>(v);</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
    </td>
  </tr>
</table>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Mar 10 2013 18:56:32 for CVODE Trajectory Generator by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
