<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CVODE Trajectory Generator: CurvedTwoBody.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CVODE Trajectory Generator
   &#160;<span id="projectnumber">Version 1: Summer 2007</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4a970e87db4491e7d599a27734f71aa8.html">problems</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CurvedTwoBody.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;CurvedTwoBody.h&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;stdexcept&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#define CUBE(x) ((x)*(x)*(x))</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define SQUARE(x) ((x)*(x))</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define SQR(x) SQUARE(x)</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#define Ith(v, i) (NV_Ith_S((v), (i)-1))</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define IJth(v, i, j) (DENSE_ELEM(v, (i)-1, (j)-1))</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#define CAPTURE 101</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define X 0</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define Y 1</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define Z 2</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="code" href="classCurvedTwoBody_a6e41ece8d9a097faa6cf00684976c99c.html#a6e41ece8d9a097faa6cf00684976c99c">   20</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classCurvedTwoBody_a6e41ece8d9a097faa6cf00684976c99c.html#a6e41ece8d9a097faa6cf00684976c99c" title="The CVODE callback function implementing the ODEs that represent this problem.">CurvedTwoBody::rhsFunc</a>( </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        realtype t, N_Vector y, N_Vector ydot, <span class="keywordtype">void</span> *myself)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="classCurvedTwoBody.html" title="Implements the general two-body problem in a curved 2-dimensional universe.">CurvedTwoBody</a>* me = (<a class="code" href="classCurvedTwoBody.html" title="Implements the general two-body problem in a curved 2-dimensional universe.">CurvedTwoBody</a>*) myself;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keyword">static</span> realtype m1, m2, R;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    m1 = me-&gt;_mass_1;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    m2 = me-&gt;_mass_2;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    R = me-&gt;_sphere_radius;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">    #define G 1</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keyword">static</span> realtype theta1, theta2, phi1, phi2, theta1prime, theta2prime, </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                    phi1prime, phi2prime;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    theta1 = Ith(y,1);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    theta2 = Ith(y,2);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    phi1 = Ith(y,3);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    phi2 = Ith(y,4);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    theta1prime = Ith(y,5);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    theta2prime = Ith(y,6);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    phi1prime = Ith(y,7);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    phi2prime = Ith(y,8);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; <span class="comment">//calculate unit vectors</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">static</span> realtype r1Hat[3];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    r1Hat[0] = sin(theta1) * cos(phi1);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    r1Hat[1] = sin(theta1) * sin(phi1);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    r1Hat[2] = cos(theta1);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keyword">static</span> realtype r2Hat[3];</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    r2Hat[0] = sin(theta2) * cos(phi2);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    r2Hat[1] = sin(theta2) * sin(phi2);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    r2Hat[2] = cos(theta2);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keyword">static</span> realtype theta1Hat[3];</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    theta1Hat[0] = cos(theta1) * cos(phi1);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    theta1Hat[1] = cos(theta1) * sin(phi1);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    theta1Hat[2] = -sin(theta1);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keyword">static</span> realtype theta2Hat[3];</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    theta2Hat[0] = cos(theta2) * cos(phi2);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    theta2Hat[1] = cos(theta2) * sin(phi2);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    theta2Hat[2] = -sin(theta2);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">static</span> realtype phi1Hat[3];</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    phi1Hat[0] = -sin(phi1);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    phi1Hat[1] = cos(phi1);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    phi1Hat[2] = 0;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">static</span> realtype phi2Hat[3];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    phi2Hat[0] = -sin(phi2);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    phi2Hat[1] = cos(phi2);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    phi2Hat[2] = 0;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// calculate forces</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keyword">static</span> realtype r1Hat_r2Hat;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    r1Hat_r2Hat = r1Hat[0] * r2Hat[0] + r1Hat[1] * r2Hat[1] + r1Hat[2] * r2Hat[2];  <span class="comment">//dot product of r1Hat and r2Hat</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keyword">static</span> realtype delta;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    delta = acos(r1Hat_r2Hat);  <span class="comment">// delta is angle between particles</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (R*delta &lt; me-&gt;_capture_radius) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        me-&gt;<a class="code" href="classAbstractProblem_aea1611edc63ef6f61950740b08ada610.html#aea1611edc63ef6f61950740b08ada610" title="Set error message.">setError</a>(CAPTURE, <span class="stringliteral">&quot;Bodies Collided.&quot;</span>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keyword">static</span> realtype dShort, dLong, fMagnitude;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    dShort = R*delta;       <span class="comment">//short distance between the two particles</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    dLong = R*(2*M_PI - delta); <span class="comment">//long distance between the two particles</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    fMagnitude = G*m1*m2 * (1/SQR(dShort) - 1/SQR(dLong));  <span class="comment">//magnitude of the gravitational force with wrap around</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keyword">static</span> realtype p1Vec[3]; <span class="comment">//Gram - Schmidt process</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    p1Vec[X] = R*r2Hat[X] - R*r1Hat_r2Hat * r1Hat[X];</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    p1Vec[Y] = R*r2Hat[Y] - R*r1Hat_r2Hat * r1Hat[Y];</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    p1Vec[Z] = R*r2Hat[Z] - R*r1Hat_r2Hat * r1Hat[Z];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keyword">static</span> realtype p2Vec[3];</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    p2Vec[X] = R*r1Hat[X] - R*r1Hat_r2Hat * r2Hat[X];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    p2Vec[Y] = R*r1Hat[Y] - R*r1Hat_r2Hat * r2Hat[Y];</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    p2Vec[Z] = R*r1Hat[Z] - R*r1Hat_r2Hat * r2Hat[Z];</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keyword">static</span> realtype p1Mag, p2Mag;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    p1Mag = sqrt (SQR(p1Vec[X]) +SQR(p1Vec[Y])+ SQR(p1Vec[Z]));</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    p2Mag = sqrt (SQR(p2Vec[X]) +SQR(p2Vec[Y])+ SQR(p2Vec[Z]));    </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keyword">static</span> realtype f1Hat[3];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    f1Hat[X] = p1Vec[X] / p1Mag;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    f1Hat[Y] = p1Vec[Y]/p1Mag;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    f1Hat[Z] = p1Vec[Z]/p1Mag;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keyword">static</span> realtype f2Hat[3]; <span class="comment">// force components in theta direction</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    f2Hat[X] = p2Vec[X] / p2Mag;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    f2Hat[Y] = p2Vec[Y]/p2Mag;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    f2Hat[Z] = p2Vec[Z]/p2Mag;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keyword">static</span> realtype f1Vec[3];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    f1Vec[X] = f1Hat[X] * fMagnitude;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    f1Vec[Y] = f1Hat[Y] * fMagnitude;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    f1Vec[Z] = f1Hat[Z] * fMagnitude;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keyword">static</span> realtype f2Vec[3];</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    f2Vec[X] = f2Hat[X] * fMagnitude;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    f2Vec[Y] = f2Hat[Y] * fMagnitude;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    f2Vec[Z] = f2Hat[Z] * fMagnitude;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keyword">static</span> realtype aVec1[3];</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    aVec1[X] = f1Vec[X]/m1;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    aVec1[Y] = f1Vec[Y]/m1;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    aVec1[Z] = f1Vec[Z]/m1;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keyword">static</span> realtype aVec2[3];</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    aVec2[X] = f2Vec[X]/m2;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    aVec2[Y] = f2Vec[Y]/m2;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    aVec2[Z] = f2Vec[Z]/m2;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keyword">static</span> realtype a1MechLin[2]; <span class="comment">//linear mechanical accelerations projections</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    a1MechLin[0] = aVec1[X]*theta1Hat[X] + aVec1[Y]*theta1Hat[Y] + aVec1[Z]*theta1Hat[Z]; <span class="comment">//acceleration in thetaHat</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    a1MechLin[1] = aVec1[X]*phi1Hat[X] + aVec1[Y]*phi1Hat[Y] + aVec1[Z]*phi1Hat[Z]; <span class="comment">//acceleration in phiHat</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keyword">static</span> realtype a2MechLin[2]; <span class="comment">//linear mechanical accelerations projections</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    a2MechLin[0] = aVec2[X]*theta2Hat[X] + aVec2[Y]*theta2Hat[Y] + aVec2[Z]*theta2Hat[Z]; <span class="comment">//acceleration in thetaHat</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    a2MechLin[1] = aVec2[X]*phi2Hat[X] + aVec2[Y]*phi2Hat[Y] + aVec2[Z]*phi2Hat[Z]; <span class="comment">//acceleration in phiHat</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keyword">static</span> realtype a1Mechanical[2]; <span class="comment">//angular mechanical acceleration projections</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    a1Mechanical[0] = a1MechLin[0]/R; <span class="comment">//acceleration in thetaHat</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    a1Mechanical[1] = a1MechLin[1]/(R*sin(theta1)); <span class="comment">//acceleration in phiHat</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">static</span> realtype a2Mechanical[2]; <span class="comment">// angular mechanical acceleration projections</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    a2Mechanical[0] = a2MechLin[0]/R; <span class="comment">//acceleration in thetaHat</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    a2Mechanical[1] = a2MechLin[1]/(R*sin(theta2)); <span class="comment">//acceleration in phiHat         </span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keyword">static</span> realtype a1Curvature[2]; <span class="comment">// effective acceleration due to curvature</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    a1Curvature[0] = cos(theta1)*sin(theta1)*SQR(phi1prime);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    a1Curvature[1] = -2*(1/tan(theta1))*theta1prime*phi1prime;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keyword">static</span> realtype a2Curvature[2]; <span class="comment">// effective acceleration due to curvature</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    a2Curvature[0] = cos(theta2)*sin(theta2)*SQR(phi2prime);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    a2Curvature[1] = -2*(1/tan(theta2))*theta2prime*phi2prime;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keyword">static</span> realtype aTheta1, aPhi1;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    aTheta1 = a1Mechanical[0] + a1Curvature[0];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    aPhi1 = a1Mechanical[1] + a1Curvature[1];</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keyword">static</span> realtype aTheta2, aPhi2;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    aTheta2 = a2Mechanical[0] + a2Curvature[0];    </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    aPhi2 = a2Mechanical[1] + a2Curvature[1];</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    Ith(ydot,1) = Ith(y,5);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    Ith(ydot,2) = Ith(y,6); </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    Ith(ydot,3) = Ith(y,7); </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    Ith(ydot,4) = Ith(y,8); </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    Ith(ydot,5) = aTheta1;  </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    Ith(ydot,6) = aTheta2;  </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    Ith(ydot,7) = aPhi1;    </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    Ith(ydot,8) = aPhi2;    </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">return</span> 0; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="code" href="classCurvedTwoBody_a30f5e5bdf2de6643a5d33435f4c32b48.html#a30f5e5bdf2de6643a5d33435f4c32b48">  178</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classCurvedTwoBody_a30f5e5bdf2de6643a5d33435f4c32b48.html#a30f5e5bdf2de6643a5d33435f4c32b48" title="The dense Jacobian function.">CurvedTwoBody::denseJac</a>( <span class="keywordtype">long</span> <span class="keywordtype">int</span> N, DenseMat J, realtype t, </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    N_Vector y, N_Vector fy, <span class="keywordtype">void</span> *jac_data, N_Vector tmp1, </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    N_Vector tmp2, N_Vector tmp3 )</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;{</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="classCurvedTwoBody.html" title="Implements the general two-body problem in a curved 2-dimensional universe.">CurvedTwoBody</a> * me = (<a class="code" href="classCurvedTwoBody.html" title="Implements the general two-body problem in a curved 2-dimensional universe.">CurvedTwoBody</a> *) jac_data;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">static</span> realtype c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                    c14, c15, c16, c17, c18, c19, c20, c21, c22;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keyword">static</span> realtype s1, s2, s3, s4, s5, s6, s7, s8, s9, s10, s11, s12, s13, </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    s14, s15, s16, s17, s18, s19, s20, s21, s22;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keyword">static</span> realtype ac1, ct1, ct2, cc1, cc2;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">static</span> realtype p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11, p12, p13, p14, p15, p16, p17, p18;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">static</span> realtype b1, b2, b3, b4, b5, b6, b7, b8, b9, b10, b11;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keyword">static</span> realtype d1, d2, d3, d4, d5, d6, d7, d8, d9, d10, d11, d12, d13, d14, d15, d16;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keyword">static</span> realtype e1, e2, e3, e4, e5, e6, e7;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keyword">static</span> realtype f1, f2, f3, f4, f5, f6, f7, f8, f9, f10, f11, f12, <span class="comment">// f13, </span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                    f14, f15, f16, f17, f18, f19, f20, f21, f22, f23, f24, </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    f25, f26, f27, f28, f29, f30, f31, f32, f33, f34, f35, </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    f36, f37, f38, f39, f40, f41, f42, f43;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keyword">static</span> realtype g1, g2, g3, g4, g5, g6;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keyword">static</span> realtype h1, h2, h3, h4, h5, h6, h7, h8, h9, h10, h11;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keyword">static</span> realtype sqrt2;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    sqrt2 = sqrt(RCONST(2.0));</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keyword">static</span> realtype m1, m2, R;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    m1 = me-&gt;_mass_1;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    m2 = me-&gt;_mass_2;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    R = me-&gt;_sphere_radius;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor">    #define G 1</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keyword">static</span> realtype theta1, theta2, phi1, phi2, theta1prime, theta2prime, </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                    phi1prime, phi2prime;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    theta1 = Ith(y,1);      <span class="comment">//theta1</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    theta2 = Ith(y,2);      <span class="comment">//theta2</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    phi1 = Ith(y,3);            <span class="comment">//phi1</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    phi2 = Ith(y,4);            <span class="comment">//phi2</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    theta1prime = Ith(y,5); <span class="comment">//theta1 prime</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    theta2prime = Ith(y,6); <span class="comment">//theta2 prime</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    phi1prime = Ith(y,7);   <span class="comment">//phi1 prime</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    phi2prime = Ith(y,8);   <span class="comment">//phi2 prime</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    c1 = cos(theta1);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    c2 = cos(theta2);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    c3 = cos(phi1);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    c4 = cos(phi2);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    c5 = cos(phi1 - phi2);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    c6 = cos(2*theta1);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    c7 = cos(2*(theta1 - theta2));</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    c8 = cos(2*theta2);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    c9 = cos(2*(theta1 + theta2));</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    c10 = cos(2*(phi1 - phi2));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    c11 = cos(2*(theta1 + phi1 - phi2));</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    c12 = cos(2*theta1 - 2*theta2 + phi1 - phi2);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    c13 = cos(2*(theta1 - theta2 + phi1 - phi2));</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    c14 = cos(2*(theta2 + phi1 - phi2));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    c15 = cos(2*(theta1 + theta2 + phi1 - phi2));</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    c16 = cos(2*theta1 + 2*theta2 + phi1 - phi2);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    c17 = cos(2*(theta1 - phi1 + phi2));</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    c18 = cos(2*theta1 - 2*theta2 - phi1 + phi2);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    c19 = cos(2*(theta1 - theta2 - phi1 + phi2));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    c20 = cos(2*(theta2 - phi1 + phi2));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    c21 = cos(2*(theta1 + theta2 - phi1 + phi2));</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    c22 = cos(2*theta1 + 2*theta2 - phi1 + phi2);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    s1 = sin(theta1);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    s2 = sin(theta2);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    s3 = sin(phi1);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    s4 = sin(phi2);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    s5 = sin(2*theta1);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    s6 = sin(2*(theta1 - theta2));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    s7 = sin(2*(theta1 + theta2));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    s8 = sin(2*(theta1 + phi1 - phi2));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    s9 = sin(2*theta1 - 2*theta2 + phi1 - phi2);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    s10 = sin(2*(theta1 - theta2 + phi1 - phi2));</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    s11 = sin(2*(theta1 + theta2 + phi1 - phi2));</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    s12 = sin(2*theta1 + 2*theta2 + phi1 - phi2);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    s13 = sin(2*(theta1 - phi1 + phi2));</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    s14 = sin(2*theta1 - 2*theta2 - phi1 + phi2);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    s15 = sin(2*(theta1 - theta2 - phi1 + phi2));</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    s16 = sin(2*(theta1 + theta2 - phi1 + phi2));</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    s17 = sin(2*theta1 + 2*theta2 - phi1 + phi2);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    s18 = sin(2*theta2);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    s19 = sin(2*(theta2 + phi1 - phi2));</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    s20 = sin(2*(theta2 - phi1 + phi2));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    s21 = sin(phi1 - phi2);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    s22 = sin(2*(phi1 - phi2));</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    ac1 = acos(c1*c2 + c5*s1*s2);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    ct1 = 1/(tan(theta1));</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    ct2 = 1/(tan(theta2));</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    cc1 = 1/(sin(theta1));</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    cc2 = 1/(sin(theta2));</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    p1 = SQR(R);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    p2 = SQR(ac1);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    p3 = SQR(s1);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    p4 = SQR(s2);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    p5 = SQR(s21);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    p6 = SQR(phi1prime);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    p7 = SQR(phi2prime);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    b1 = c2*s1 - c1*c5*s2;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    b2 = c1*c2 + c5*s1*s2;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    b3 = -ac1+M_PI;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    b4 = ac1-2*M_PI;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    b5 = -20 + 4*c10 - 2*c11 + 4*c12 + c13 - 2*c14 + c15 - 4*c16 - 2*c17 + 4*c18 + c19 - 2*c20 + c21 - 4*c22 + 4*c6 + 6*c7 + 4*c8 + 6*c9;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    b6 = c2*c5*s1 - c1*s2;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    b7 = -2*ct2;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    b8 = -c1*c2*c5 - s1*s2;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    b9 = -2*s10 - 2*s11 + 8*s12 + 4*s13 - 8*s14 - 2*s15 - 2*s16 + 8*s17 - 8*s5 - 12*s6 - 12*s7 + 4*s8 - 8*s9;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    b10 = -c3*p3*R*s2*s21 - R*s2*s4;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    b11 = -c4*R*s2 + p3*R*s2*s21*s3;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    p8 = SQR(b1);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    p9 = SQR(b2);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    p10 = SQR(b4);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    p16 = SQR(b6);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    p11 = SQR(p1);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    d1 = -b2*c1*c3*R + b1*c3*R*s1;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    d2 = -b2*c3*R*s1 + c4*R*s2;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    d3 = b2*c1*R*s3 - b1*R*s1*s3;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    d4 = b2*R*s1*s3 - R*s2*s4;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    d5 = -8*b1*b3*G*m2*M_PI + (p1*sqrt(-b5*p1)*p10*p2*p6*s5)/(4*sqrt2);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    d6 = c3*R*s1 - b2*c4*R*s2;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    d7 = 8*b3*b6*G*m1*M_PI + (p1*sqrt(-b5*p1)*p10*p2*p7*s18)/(4*sqrt2);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    d8 = R*s1*s3 - b2*R*s2*s4;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    d9 = c1*c3*R + b1*c4*R*s2;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    d10 = -b2*c2*c4*R - b6*c4*R*s2;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    d11 = c2*c4*R - b6*c3*R*s1;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    d12 = b6*R*s1*s3 - c2*R*s4;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    d13 = c1*R*s3 + b1*R*s2*s4;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    d14 = c3*p3*R*s2*s21 + b2*R*s1*s3;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    d15 = -c4*p4*R*s1*s21 + b2*R*s2*s4;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    d16 = -b2*c4*R*s2 - p4*R*s1*s21*s4;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    p12 = SQR(d2);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    p13 = SQR(d4);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    p14 = SQR(d6);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    p15 = SQR(d8);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    p17 = (ac1*p2);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    p18 = (b4*p10);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    e1 = p12 + p13 + p1*p3*p8;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    e2 = ac1*p10 + b4*p2;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    e3 = sqrt(-b5*p1);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    e4 = sqrt(2 - 2*p9);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    e5 = sqrt(1 - p9);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    e6 = p10*p2;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    e7 = p14 + p15 + p1*p16*p4;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    f1 = sqrt(e1*e1*e1)*p1;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    f2 = sqrt(e7*e7*e7)*p1;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    f3 = 4*sqrt2*e3;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    f4 = s10 + s11 - 2*s12 + 2*s13 - 2*s14 - s15 - s16 + 2*s17 - 2*s19 + 2*s20 + 4*s22 - 2*s8 + 2*s9;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    f5 = -s10 + s11 - 4*s12 - 4*s14 - s15 + s16 - 4*s17 + 4*s18 - 2*s19 - 2*s20 - 6*s6 + 6*s7 - 4*s9;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    f6 = b1*c1*p1 - d4*R*s3;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    f7 = c4*d6*p4*s21 - d6*s3 + d8*p4*s21*s4;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    f8 = e5*p10*p17;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    f9 = e5*p18*p2;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    f10 = e5*e6*p1;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    f11 = c3*d8*R + f7*R - b6*c2*p1*p4*s21;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    f12 = sqrt(e7*e7*e7)*f10*p17*p18;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">//f13 = e5*e6*f1*p17*p18;</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    f14 = 4*b3*e1*p4*p5;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    f15 = -f14/f8 - f14/f9 - (2*e1*p4*p5)/(e5*e6) + (2*b3*c5*cc1*e1*s2)/e6;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    f16 = (e6*f4*p11*p7*s18)/f3 - 8*b3*c2*G*m1*M_PI*s1*s21 - (8*b6*G*m1*M_PI*s1*s2*s21)/e5 + (ac1*e3*p1*p10*p7*s1*s18*s2*s21)/(2*e4) + (b4*e3*p1*p2*p7*s1*s18*s2*s21)/(2*e4);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    f17 = 4*b1*d7*e7;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    f18 = 4*b1*d5*e1;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    f19 = 4*b6*d5*e1;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    f20 = 4*b6*d7*e7;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    f21 = 4*d5*e1*s1*s2*s21;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    f22 = d1*d2 + d3*d4;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    f23 = 2*e7*f16;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    f24 = 4*d7*e7*s1*s2*s21;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    f25 = p10*p17 + p18*p2;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    f26 = 8*b1*G*m2*M_PI*s1*s2*s21;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    f27 = 8*b3*c1*G*m2*M_PI*s2*s21;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    f28 = e6*f4*p11*p6*s5;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    f29 = ac1*e3*p1*p10*p6*s1*s2*s21*s5;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    f30 = b4*e3*p1*p2*p6*s1*s2*s21*s5;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    f31 = 2*e7*p3*p5;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    f32 = 4*b3*e7*p3*p5;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    f33 = 2*b3*c5*cc2*e7*s1;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    f34 = 2*b3*cc1*s2*s21;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    f35 = e5*p17*p18;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    f36 = d11*d2 + d12*d4 + b1*b8*p1*p3;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    f37 = b10*d2 + b11*d4 - b1*c1*p1*p3*s2*s21;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    f38 = d15*d6 + d16*d8 + b6*c2*p1*p4*s1*s21;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    f39 = d14*d2 + b2*c3*d4*R*s1 + f6*p3*s2*s21;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    f40 = ac1*b6*e3*p1*p10;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    f41 = e6*f5*p11;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    f42 = b4*b6*e3*p1*p2;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    f43 = b2*e5*p1*p17;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    g1 = e5*f28 + f26*f3 - e5*f27*f3;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    g2 = e5*f3*(f29 + f30) + 2*e4*g1;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    g3 = e3*e5*e6;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    g4 = e6*f1*f35;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    g5 = p17*p18;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    g6 = b5*SQR(p1);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    h1 = f8 + f9;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    h2 = 4*e6*f2*f8*f9;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    h3 = e5*e6*f2*f8*f9;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    h4 = f8*f9*g3;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    h5 = 4*e4*e5*e6*f1*f3*f8*f9;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    h6 = f1*h4;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    h7 = f2*h4;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    h8 = e1*f8*f9*g2;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    h9 = e6*f24*h1;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    h10 = f31*f8*f9;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    h11 = e6*f32*h1;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    IJth(J,1,1) = 0;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    IJth(J,1,2) = 0;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    IJth(J,1,3) = 0;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    IJth(J,1,4) = 0;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    IJth(J,1,5) = 1;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    IJth(J,1,6) = 0;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    IJth(J,1,7) = 0;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    IJth(J,1,8) = 0;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    IJth(J,2,1) = 0;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    IJth(J,2,2) = 0;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    IJth(J,2,3) = 0;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    IJth(J,2,4) = 0;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    IJth(J,2,5) = 0;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    IJth(J,2,6) = 1;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    IJth(J,2,7) = 0;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    IJth(J,2,8) = 0;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    IJth(J,3,1) = 0;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    IJth(J,3,2) = 0;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    IJth(J,3,3) = 0;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    IJth(J,3,4) = 0;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    IJth(J,3,5) = 0;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    IJth(J,3,6) = 0;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    IJth(J,3,7) = 1;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    IJth(J,3,8) = 0;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    IJth(J,4,1) = 0;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    IJth(J,4,2) = 0;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    IJth(J,4,3) = 0;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    IJth(J,4,4) = 0;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    IJth(J,4,5) = 0;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    IJth(J,4,6) = 0;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    IJth(J,4,7) = 0;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    IJth(J,4,8) = 1;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    IJth(J,5,1) = -(16*d5*h4*(f22 + b1*b2*p1*p3 + c1*p1*p8*s1) + e1*SQR(e6)*f8*f9*p6*(4*sqrt2*c6*e5*g6 + b9*e4*p11*s5) + 4*e6*(2*f18*g3*h1 + e1*f8*f9*(32*b2*b3*e3*e5*G*m2*M_PI - 32*e3*G*m2*p8*M_PI + sqrt2*b1*e2*g6*p6*s5)))/(32*e6*h6);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    IJth(J,5,2) =(-(e1*e5*f3*(f40 + f42)*f8*f9*p6*s5) + e4*(-16*b1*b6*e1*f3*f8*f9*G*m2*M_PI + e5*(e6*f19*f3*h1 - 2*f8*f9*(d5*f3*f36 + 8*b3*b8*e1*f3*G*m2*M_PI - e1*f41*p6*s5))))/h5;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    IJth(J,5,3) = (-(e4*e5*f3*(2*d5*f39*f8*f9 + e6*f21*h1)) + h8)/h5;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    IJth(J,5,4) = (e4*e5*f3*(-2*d5*f37*f8*f9 + e6*f21*h1) - h8)/h5;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    IJth(J,5,5) = 0;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    IJth(J,5,6) = 0;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    IJth(J,5,7) = (e3*s5*phi1prime)/(4*sqrt2*sqrt(e1));</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    IJth(J,5,8) = 0;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    IJth(J,6,1) = -(8*e3*(16*b1*b6*e7*f8*f9*G*m1*M_PI + e5*(e6*f17*h1 + 2*f8*f9*(d13*d7*d8 + d6*d7*d9 - b6*b8*d7*p1*p4 + 8*b3*b8*e7*G*m1*M_PI))) + sqrt2*e7*f8*f9*(4*b1*e2*g6 + b9*e5*e6*p11)*p7*s18)/(32*h7);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    IJth(J,6,2) = (2*sqrt2*c8*SQR(e3)*e7*f10*f8*f9*p7 + sqrt2*e5*e7*f41*f8*f9*p7*s18 + e3*(2*e7*f8*f9*(32*G*m1*p16*M_PI - sqrt2*(f40 + f42)*p7*s18) + 4*e5*(e6*f20*h1 + 2*f8*f9*(-(d10*d6*d7) + d7*s2*(-(c2*p1*p16) + b6*d8*R*s4) + b2*(b6*d7*p1*p4 - 8*b3*e7*G*m1*M_PI + c2*d7*d8*R*s4)))))/(16*h7);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    IJth(J,6,3) = (-h9 + f8*f9*(f23 - 2*d7*f11*s1))/h2;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    IJth(J,6,4) = (-((f23 + 2*d7*f38)*f8*f9) + h9)/h2;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    IJth(J,6,5) = 0;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    IJth(J,6,6) = 0;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    IJth(J,6,7) = 0;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    IJth(J,6,8) = (e3*s18*phi2prime)/(4*sqrt2*sqrt(e7));</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    IJth(J,7,1) = (2*cc1*(2*b1*e1*G*g5*m2*M_PI*s2*s21 + 2*b3*G*m2*M_PI*(ct1*e1*f35 + f22*f35 + 2*b1*e1*p10*p17 + 2*b1*p12*p18*p2 + 2*b1*p13*p18*p2 + b1*f43*p18*p3 + 2*b1*p1*p18*p2*p3*p8 + c1*f35*p1*p8*s1)*s2*s21 + cc1*g4*theta1prime*phi1prime))/g4;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    IJth(J,7,2) = (-4*cc1*G*m2*M_PI*(b6*e1*g5*s2 + b3*(c2*e1*f35 + 2*b6*e1*f25*s2 - f35*f36*s2))*s21)/g4;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    IJth(J,7,3) = (2*(-(e6*f15) + f34*f39)*G*m2*M_PI)/(e6*f1);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    IJth(J,7,4) = (2*(e6*f15 + f34*f37)*G*m2*M_PI)/(e6*f1);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    IJth(J,7,5) = -2*ct1*phi1prime;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    IJth(J,7,6) = 0;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    IJth(J,7,7) = -2*ct1*theta1prime;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    IJth(J,7,8) = 0;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    IJth(J,8,1) = (-4*cc2*G*m1*M_PI*(b1*e7*g5*s1 + b3*(-(c1*e7*f35) + (2*b1*e7*f25 + d13*d8*f35 + d6*d9*f35 - b6*b8*f35*p1*p4)*s1))*s21)/f12;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    IJth(J,8,2) = (2*cc2*(2*b3*G*m1*M_PI*s1*s21*(-(d10*d6*f35) - ct2*e7*f35 + 2*b6*e7*p10*p17 + 2*b6*p14*p18*p2 + 2*b6*p15*p18*p2 + b6*f43*p18*p4 + 2*b6*p1*p16*p18*p2*p4 - c2*f35*p1*p16*s2 + b2*c2*d8*f35*R*s4 + b6*d8*e5*g5*R*s2*s4) + e7*g5*(2*b6*G*m1*M_PI*s1*s21 + cc2*sqrt(e7)*f10*theta2prime*phi2prime)))/f12;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    IJth(J,8,3) = (-2*G*m1*M_PI*(h10 + e5*(-(f33*f8*f9) + h11 + 2*b3*cc2*f11*f8*f9*p3*s21)))/h3;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    IJth(J,8,4) = (2*G*m1*M_PI*(h10 + e5*(h11 - f8*f9*(f33 + 2*b3*cc2*f38*s1*s21))))/h3;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    IJth(J,8,5) = 0;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    IJth(J,8,6) = b7*phi2prime;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    IJth(J,8,7) = 0;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    IJth(J,8,8) = b7*theta2prime;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">return</span> 0; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;}</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno"><a class="code" href="classCurvedTwoBody_ae7463ee8866c29ea75e4ac1a144138c9.html#ae7463ee8866c29ea75e4ac1a144138c9">  476</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classCurvedTwoBody_ae7463ee8866c29ea75e4ac1a144138c9.html#ae7463ee8866c29ea75e4ac1a144138c9" title="Handle command-line options.">CurvedTwoBody::handleOption</a>(<span class="keywordtype">int</span> arg)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;{</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">switch</span> (arg)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">case</span> <span class="charliteral">&#39;P&#39;</span>: <span class="comment">// initial separation (\rho_0) </span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            setInitialSeparation(atof(optarg));</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: <span class="comment">//sphere size</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            setSphereRadius(atof(optarg));</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">case</span> <span class="charliteral">&#39;V&#39;</span>: <span class="comment">// difference in initial velocities of particle one and two</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            setDeltaV(atof(optarg));</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>: <span class="comment">// capture radius</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            setCaptureRadius(atof(optarg));</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>: <span class="comment">// mass fraction</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            setMassFraction(atof(optarg));</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;}</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno"><a class="code" href="classCurvedTwoBody_a7222a3aecf0dfd91196ed92e9014a97b.html#a7222a3aecf0dfd91196ed92e9014a97b">  502</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCurvedTwoBody_a7222a3aecf0dfd91196ed92e9014a97b.html#a7222a3aecf0dfd91196ed92e9014a97b" title="Set initial separation.">CurvedTwoBody::setInitialSeparation</a>(realtype r)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;{</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    _initial_separation = r;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    updateInitialVector();</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;}</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno"><a class="code" href="classCurvedTwoBody_ae7499dfcc4c15f142483fd7c32eacf5a.html#ae7499dfcc4c15f142483fd7c32eacf5a">  508</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCurvedTwoBody_ae7499dfcc4c15f142483fd7c32eacf5a.html#ae7499dfcc4c15f142483fd7c32eacf5a" title="Set .">CurvedTwoBody::setDeltaV</a>(realtype s)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;{</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    _delta_v = s;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    updateInitialVector();</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;}</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno"><a class="code" href="classCurvedTwoBody_aded44282503f87086bb75f07a9630970.html#aded44282503f87086bb75f07a9630970">  514</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCurvedTwoBody_aded44282503f87086bb75f07a9630970.html#aded44282503f87086bb75f07a9630970" title="Set fraction of the total mass given to the first body.">CurvedTwoBody::setMassFraction</a>(realtype f)</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;{</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">if</span> (f &lt; 0 || f &gt; 1)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">throw</span> invalid_argument(<span class="stringliteral">&quot;CurvedTwoBody::setMassFraction(): mass fraction must be between 0 and 1.&quot;</span>);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    _mass_1 = f;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    _mass_2 = 1 - f;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;}</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment"> * Update the initial velocity vector to reflect the initial conditions</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment"> * specified by _delta_v and _initial_separation.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00527"></a><span class="lineno"><a class="code" href="classCurvedTwoBody_a77d962836f16bb5657196e636e15a68a.html#a77d962836f16bb5657196e636e15a68a">  527</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCurvedTwoBody_a77d962836f16bb5657196e636e15a68a.html#a77d962836f16bb5657196e636e15a68a" title="Update the initial vector to match initial separation, velocity difference, and mass fraction...">CurvedTwoBody::updateInitialVector</a>() </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;{</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    vector&lt;realtype&gt; v(getVectorSize());</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">// v = (q1, q2, j1, j2, q1&#39;, q2&#39;, j1&#39;, j2&#39;)</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    v.at(0) = (_initial_separation*_mass_2)/(_sphere_radius*(_mass_1+_mass_2)); <span class="comment">// theta1 = theta1 initial</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    v.at(1) = (_initial_separation*_mass_1)/(_sphere_radius*(_mass_1+_mass_2));     <span class="comment">// theta2 = theta2 initial</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    v.at(2) = 0;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    v.at(3) = M_PI;                     <span class="comment">// phi2 = phi2 initial</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    v.at(4) = 0;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    v.at(5) = 0;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    v.at(6) = (_delta_v*_mass_2)/((_mass_1+_mass_2)*_sphere_radius*sin(v.at(0)));           <span class="comment">// phi1prime = phi1prime initial</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    v.at(7) = (_delta_v*_mass_1)/((_mass_1+_mass_2)*_sphere_radius*sin(v.at(1)));           <span class="comment">// phi2prime = phi2prime initial</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    setInitialVector(v);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;}</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno"><a class="code" href="classCurvedTwoBody_a013a54ef7dfbe554aee7fd0df6487ceb.html#a013a54ef7dfbe554aee7fd0df6487ceb">  545</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCurvedTwoBody_a013a54ef7dfbe554aee7fd0df6487ceb.html#a013a54ef7dfbe554aee7fd0df6487ceb" title="Set capture radius.">CurvedTwoBody::setCaptureRadius</a>(realtype r)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;{</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    _capture_radius = r;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;}</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div>
<div class="line"><a name="l00550"></a><span class="lineno"><a class="code" href="classCurvedTwoBody_ad768a98ec9f5c81e6984d93def0fe664.html#ad768a98ec9f5c81e6984d93def0fe664">  550</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCurvedTwoBody_ad768a98ec9f5c81e6984d93def0fe664.html#ad768a98ec9f5c81e6984d93def0fe664" title="Set sphere radius.">CurvedTwoBody::setSphereRadius</a>(realtype r)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;{</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    _sphere_radius = r;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    updateInitialVector();</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;}</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno"><a class="code" href="classCurvedTwoBody_a166ff775e4572bd2d506562cbd9f4cfd.html#a166ff775e4572bd2d506562cbd9f4cfd">  556</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCurvedTwoBody_a166ff775e4572bd2d506562cbd9f4cfd.html#a166ff775e4572bd2d506562cbd9f4cfd" title="Write the first line of output.">CurvedTwoBody::recordDataInit</a>()</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;{</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;t\tj1\tq1\tj2\tq2&quot;</span> &lt;&lt; endl; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno"><a class="code" href="classCurvedTwoBody_aa5669c474886ba75d17addef3daf19e1.html#aa5669c474886ba75d17addef3daf19e1">  561</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCurvedTwoBody_aa5669c474886ba75d17addef3daf19e1.html#aa5669c474886ba75d17addef3daf19e1" title="Record data to stdout.">CurvedTwoBody::recordData</a>(realtype t, N_Vector y)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;{</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    cout &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            &lt;&lt; Ith(y,3) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            &lt;&lt; Ith(y,1) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            &lt;&lt; Ith(y,4) &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            &lt;&lt; Ith(y,2)</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            &lt;&lt; endl;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;}</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    </div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Mar 10 2013 18:56:30 for CVODE Trajectory Generator by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
